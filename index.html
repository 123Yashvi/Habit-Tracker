<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#317EFB" />
  <link rel="manifest" href="manifest.json" />
  <title>Smart Goal & Habit Tracker</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f4f8;
      padding: 20px;
      color: #333;
    }
    h1, h2 {
      color: #004080;
    }
    .container {
      max-width: 900px;
      margin: auto;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input, select {
      padding: 6px;
      width: 100%;
      margin-top: 4px;
    }
    button {
      padding: 10px 15px;
      background: #004080;
      color: white;
      border: none;
      margin-top: 15px;
      cursor: pointer;
      border-radius: 6px;
    }
    button:hover {
      background: #0055aa;
    }
    .entry-section {
      background: #fff;
      padding: 20px;
      margin-top: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .goal-table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
    }
    .goal-table th, .goal-table td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    .goal-table th {
      background: #e0eaff;
    }
    .yesno {
      color: green;
      font-weight: bold;
    }
    .status-pending { color: orange; font-weight: bold; }
    .status-complete { color: green; font-weight: bold; }
    .status-lagging { color: red; font-weight: bold; }
    canvas { max-width: 100%; margin-top: 40px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìä Smart Goal & Habit Tracker</h1>
    <div class="entry-section">
      <h2>Add New Goal or Habit</h2>
      <label>Goal Name:<input id="goalName" /></label>
      <label>Goal Type:
        <select id="goalType">
          <option value="number">Number</option>
          <option value="yesno">Yes / No</option>
          <option value="time">Time (HH:MM)</option>
          <option value="note">Note / Just Track</option>
        </select>
      </label>
      <label>Target Amount (if applicable):<input id="goalTarget" type="number" /></label>
      <label>Unit (eg. kg, times, mins):<input id="goalUnit" /></label>
      <label>Start Date:<input id="goalStart" type="date" /></label>
      <label>End Date:<input id="goalEnd" type="date" /></label>
      <button onclick="saveGoal()">üíæ Save Goal</button>
    </div><div class="entry-section">
  <h2>üìÖ Enter Daily Progress</h2>
  <label>Choose Goal:
    <select id="goalSelect"></select>
  </label>
  <label>Entry Date:<input id="entryDate" type="date" /></label>
  <label>Entry Time:<input id="entryTime" type="time" /></label>
  <label>Value:<input id="entryValue" /></label>
  <button onclick="addProgress()">üìå Add Progress</button>
</div>

<div class="entry-section">
  <h2>üßæ All Goals Overview</h2>
  <table class="goal-table" id="goalTable">
    <thead>
      <tr><th>Goal</th><th>Target</th><th>Progress</th><th>%</th><th>Status</th><th>Start</th><th>End</th><th>Actions</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<canvas id="chart"></canvas>

  </div>  <script>
    const goals = JSON.parse(localStorage.getItem('goals') || '[]');
    const progress = JSON.parse(localStorage.getItem('progress') || '[]');

    function saveGoal() {
      const goal = {
        name: goalName.value.trim(),
        type: goalType.value,
        target: parseFloat(goalTarget.value) || null,
        unit: goalUnit.value.trim(),
        start: goalStart.value,
        end: goalEnd.value,
        id: Date.now()
      };
      goals.push(goal);
      localStorage.setItem('goals', JSON.stringify(goals));
      updateGoalSelect();
      renderGoals();
    }

    function updateGoalSelect() {
      goalSelect.innerHTML = goals.map(g => `<option value="${g.id}">${g.name}</option>`).join('');
    }

    function addProgress() {
      const val = entryValue.value.trim().toLowerCase();
      const type = goals.find(g => g.id == goalSelect.value)?.type;
      let finalValue;
      if (type === 'yesno') finalValue = val === 'yes' || val === 'y' ? 1 : 0;
      else if (type === 'time') finalValue = entryTime.value;
      else finalValue = parseFloat(val) || val;

      progress.push({
        goalId: parseInt(goalSelect.value),
        date: entryDate.value,
        time: entryTime.value,
        value: finalValue
      });
      localStorage.setItem('progress', JSON.stringify(progress));
      renderGoals();
    }

    function renderGoals() {
      const tbody = document.querySelector('#goalTable tbody');
      tbody.innerHTML = '';
      goals.forEach(g => {
        const entries = progress.filter(p => p.goalId === g.id);
        let prog = 0;
        if (g.type === 'yesno') prog = entries.reduce((acc, e) => acc + (e.value ? 1 : 0), 0);
        else if (g.type === 'number') prog = entries.reduce((acc, e) => acc + parseFloat(e.value || 0), 0);
        const percent = g.target ? Math.round((prog / g.target) * 100) : 'N/A';
        let status = 'Pending';
        if (percent === 'N/A') status = 'Tracking';
        else if (percent >= 100) status = 'Complete';
        else if (percent < 50) status = 'Lagging';

        tbody.innerHTML += `
          <tr>
            <td>${g.name}</td>
            <td>${g.target || '-'} ${g.unit || ''}</td>
            <td>${prog}</td>
            <td>${percent}%</td>
            <td class="status-${status.toLowerCase()}">${status}</td>
            <td>${g.start}</td>
            <td>${g.end}</td>
            <td><button onclick="editGoal(${g.id})">‚úèÔ∏è</button> <button onclick="deleteGoal(${g.id})">üóëÔ∏è</button></td>
          </tr>`;
      });
    }

    function editGoal(id) {
      const g = goals.find(x => x.id === id);
      goalName.value = g.name;
      goalType.value = g.type;
      goalTarget.value = g.target;
      goalUnit.value = g.unit;
      goalStart.value = g.start;
      goalEnd.value = g.end;
      deleteGoal(id);
    }

    function deleteGoal(id) {
      const index = goals.findIndex(x => x.id === id);
      goals.splice(index, 1);
      localStorage.setItem('goals', JSON.stringify(goals));
      renderGoals();
      updateGoalSelect();
    }

    updateGoalSelect();
    renderGoals();
  </script></body>
</html>
